<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>智能视频编辑器</title>
    <link rel="stylesheet" href="/static/css/style.css">
    <link rel="stylesheet" href="/static/css/video_editor.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/remixicon@2.5.0/fonts/remixicon.css">
</head>
<body>
    <!-- 全局工具栏 -->
    <div class="global-toolbar">
        <div class="toolbar-left">
            <button class="back-btn" onclick="window.location.href='/'">
                <i class="ri-arrow-left-line"></i>
            </button>
            <h1><i class="ri-video-edit-line"></i> 智能视频编辑器</h1>
        </div>
        <div class="toolbar-right">
            <button class="save-preset-btn" onclick="savePreset()">
                <i class="ri-save-line"></i> 保存预设
            </button>
            <button class="load-preset-btn" onclick="loadPreset()">
                <i class="ri-folder-open-line"></i> 加载预设
            </button>
        </div>
    </div>

    <div class="editor-container">
        <!-- 左侧：视频源选择和预览 -->
        <div class="editor-left">
            <div class="section">
                <h2><i class="ri-video-line"></i> 视频源选择</h2>
                
                <!-- 选择视频源类型 -->
                <div class="source-type-selector">
                    <label class="radio-label">
                        <input type="radio" name="sourceType" value="upload" checked onchange="toggleSourceType()">
                        <i class="ri-radio-button-line unchecked"></i>
                        <i class="ri-checkbox-circle-line checked"></i>
                        <span>上传视频文件</span>
                    </label>
                    <label class="radio-label">
                        <input type="radio" name="sourceType" value="folder" onchange="toggleSourceType()">
                        <i class="ri-radio-button-line unchecked"></i>
                        <i class="ri-checkbox-circle-line checked"></i>
                        <span>从downloads文件夹选择</span>
                    </label>
                </div>
                
                <!-- 文件上传 -->
                <div class="video-input" id="upload-section">
                    <div class="upload-area" onclick="document.getElementById('video-file').click()">
                        <i class="ri-upload-cloud-line"></i>
                        <p>点击选择视频文件</p>
                        <span>支持 MP4, AVI, MOV, MKV 格式</span>
                    </div>
                    <input type="file" id="video-file" accept="video/*" onchange="handleVideoSelect(this)">
                </div>
                
                <!-- 文件夹选择 -->
                <div class="folder-input" id="folder-select-section" style="display: none;">
                    <div class="folder-select">
                        <label><i class="ri-folder-line"></i> 选择文件夹</label>
                        <select id="folder-select" onchange="loadFolderVideos()">
                            <option value="">请选择下载文件夹</option>
                        </select>
                    </div>
                    <div class="video-select" id="video-select-section" style="display: none;">
                        <div class="video-select-header">
                            <label><i class="ri-video-line"></i> 选择视频</label>
                            <div class="batch-controls">
                                <button class="batch-btn" id="select-all-btn" onclick="selectAllVideos()">
                                    <i class="ri-checkbox-multiple-line"></i> 全选
                                </button>
                                <button class="batch-btn" id="clear-all-btn" onclick="clearAllVideos()" style="display: none;">
                                    <i class="ri-close-circle-line"></i> 清空
                                </button>
                            </div>
                        </div>
                        <select id="video-select" multiple onchange="handleFolderVideoSelect()">
                            <option value="">请选择视频文件</option>
                        </select>
                        <div class="selected-count" id="selected-count" style="display: none;">
                            已选择 <span id="count-number">0</span> 个视频文件
                        </div>
                    </div>
                </div>
                
                <div class="video-input">
                    
                    <div class="selected-video" id="selected-video" style="display: none;">
                        <div class="video-info">
                            <i class="ri-play-circle-line"></i>
                            <div class="info">
                                <h4 id="video-name">未选择视频</h4>
                                <div class="video-details">
                                    <span id="video-size">0 MB</span>
                                    <span id="video-duration">00:00</span>
                                    <span id="video-resolution">0x0</span>
                                </div>
                            </div>
                        </div>
                        <button class="remove-video" onclick="removeVideo()">
                            <i class="ri-close-line"></i>
                        </button>
                    </div>
                </div>

                <div class="video-preview">
                    <h3><i class="ri-tv-line"></i> 视频预览</h3>
                    <div class="preview-container">
                        <video id="preview-video" controls style="display: none;">
                            您的浏览器不支持视频播放
                        </video>
                        <div class="no-video-placeholder" id="no-video-placeholder">
                            <i class="ri-film-line"></i>
                            <p>请先选择视频文件</p>
                        </div>
                    </div>
                    <div class="preview-controls">
                        <button id="preview-btn" class="preview-btn" onclick="previewVideo()" disabled>
                            <i class="ri-play-line"></i> 预览效果
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- 中间：编辑控制区 -->
        <div class="editor-center">
            <!-- 画面调整 -->
            <div class="section">
                <h2><i class="ri-contrast-line"></i> 画面调整</h2>
                <div class="adjustment-controls">
                    <div class="control-group">
                        <label><i class="ri-sun-line"></i> 亮度</label>
                        <div class="range-control">
                            <input type="range" id="brightness" min="-100" max="100" value="0" oninput="updateAdjustment()">
                            <span id="brightness-value">0</span>
                            <button class="random-btn" onclick="randomAdjust('brightness', -20, 20)">
                                <i class="ri-shuffle-line"></i>
                            </button>
                        </div>
                    </div>
                    
                    <div class="control-group">
                        <label><i class="ri-contrast-fill"></i> 对比度</label>
                        <div class="range-control">
                            <input type="range" id="contrast" min="-100" max="100" value="0" oninput="updateAdjustment()">
                            <span id="contrast-value">0</span>
                            <button class="random-btn" onclick="randomAdjust('contrast', -15, 15)">
                                <i class="ri-shuffle-line"></i>
                            </button>
                        </div>
                    </div>
                    
                    <div class="control-group">
                        <label><i class="ri-palette-line"></i> 饱和度</label>
                        <div class="range-control">
                            <input type="range" id="saturation" min="-100" max="100" value="0" oninput="updateAdjustment()">
                            <span id="saturation-value">0</span>
                            <button class="random-btn" onclick="randomAdjust('saturation', -25, 25)">
                                <i class="ri-shuffle-line"></i>
                            </button>
                        </div>
                    </div>
                    
                    <div class="control-group">
                        <label><i class="ri-focus-line"></i> 锐化</label>
                        <div class="range-control">
                            <input type="range" id="sharpen" min="0" max="100" value="0" oninput="updateAdjustment()">
                            <span id="sharpen-value">0</span>
                            <button class="random-btn" onclick="randomAdjust('sharpen', 0, 30)">
                                <i class="ri-shuffle-line"></i>
                            </button>
                        </div>
                    </div>
                    
                    <div class="control-group">
                        <label><i class="ri-sound-module-line"></i> 降噪</label>
                        <div class="range-control">
                            <input type="range" id="denoise" min="0" max="100" value="0" oninput="updateAdjustment()">
                            <span id="denoise-value">0</span>
                            <button class="random-btn" onclick="randomAdjust('denoise', 0, 20)">
                                <i class="ri-shuffle-line"></i>
                            </button>
                        </div>
                    </div>

                    <button class="reset-btn" onclick="resetAdjustments()">
                        <i class="ri-restart-line"></i> 重置所有调整
                    </button>
                </div>
            </div>

            <!-- 分屏效果 -->
            <div class="section">
                <h2><i class="ri-layout-grid-line"></i> 分屏效果</h2>
                <div class="split-screen-controls">
                    <div class="checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="enable-split" onchange="toggleSplitScreen()">
                            <i class="ri-checkbox-blank-line unchecked"></i>
                            <i class="ri-checkbox-line checked"></i>
                            <span>启用宫格分屏</span>
                        </label>
                    </div>
                    
                    <div class="split-options" id="split-options" style="display: none;">
                        <div class="control-group">
                            <label><i class="ri-layout-line"></i> 分屏方向</label>
                            <select id="split-direction" onchange="updateSplitScreen()">
                                <option value="vertical">上下（上中下）</option>
                                <option value="horizontal">左右（左中右）</option>
                                <option value="auto">自动选择</option>
                            </select>
                        </div>
                        
                        <div class="control-group">
                            <label><i class="ri-grid-line"></i> 分割比例</label>
                            <select id="split-ratio" onchange="updateSplitScreen()">
                                <option value="equal">均等分割</option>
                                <option value="center-large">中间放大</option>
                                <option value="edges-large">两端放大</option>
                            </select>
                        </div>
                        
                        <div class="checkbox-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="enable-blur" onchange="updateSplitScreen()">
                                <i class="ri-checkbox-blank-line unchecked"></i>
                                <i class="ri-checkbox-line checked"></i>
                                <span>边界柔化效果</span>
                            </label>
                        </div>
                    </div>
                </div>
            </div>

            <!-- AB帧融合 -->
            <div class="section">
                <h2><i class="ri-merge-cells-horizontal"></i> AB帧融合</h2>
                <div class="ab-fusion-controls">
                    <div class="checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="enable-ab-fusion" onchange="toggleABFusion()">
                            <i class="ri-checkbox-blank-line unchecked"></i>
                            <i class="ri-checkbox-line checked"></i>
                            <span>启用AB帧融合</span>
                        </label>
                    </div>
                    
                    <div class="ab-fusion-options" id="ab-fusion-options" style="display: none;">
                        <!-- B视频选择 -->
                        <div class="control-group">
                            <label><i class="ri-video-add-line"></i> B视频(平台识别层)</label>
                            <div class="b-video-selector">
                                <select id="b-video-source" onchange="toggleBVideoSource()">
                                    <option value="upload">上传B视频文件</option>
                                    <option value="builtin">使用内置素材库</option>
                                    <option value="generate">AI生成无版权素材</option>
                                </select>
                            </div>
                        </div>
                        
                        <!-- B视频上传 -->
                        <div class="b-video-upload" id="b-video-upload-section">
                            <div class="upload-area-small" onclick="document.getElementById('b-video-file').click()">
                                <i class="ri-upload-line"></i>
                                <span>选择B视频文件</span>
                            </div>
                            <input type="file" id="b-video-file" accept="video/*" onchange="handleBVideoSelect(this)">
                            <div class="selected-b-video" id="selected-b-video" style="display: none;">
                                <span id="b-video-name">未选择B视频</span>
                                <button onclick="removeBVideo()"><i class="ri-close-line"></i></button>
                            </div>
                        </div>
                        
                        <!-- 内置素材库 -->
                        <div class="builtin-materials" id="builtin-materials-section" style="display: none;">
                            <select id="builtin-material" onchange="updateABFusion()">
                                <option value="">选择内置素材</option>
                                <option value="nature_1">自然风景01 - 山水</option>
                                <option value="nature_2">自然风景02 - 云海</option>
                                <option value="abstract_1">抽象背景01 - 几何</option>
                                <option value="abstract_2">抽象背景02 - 流体</option>
                                <option value="texture_1">材质纹理01 - 木纹</option>
                                <option value="texture_2">材质纹理02 - 金属</option>
                            </select>
                        </div>
                        
                        <!-- AI生成选项 -->
                        <div class="ai-generate-options" id="ai-generate-section" style="display: none;">
                            <div class="control-group">
                                <label>生成类型</label>
                                <select id="ai-generate-type">
                                    <option value="nature">自然场景</option>
                                    <option value="abstract">抽象图案</option>
                                    <option value="noise">随机噪声</option>
                                    <option value="gradient">渐变背景</option>
                                </select>
                            </div>
                            <button class="generate-btn" onclick="generateBVideo()">
                                <i class="ri-magic-line"></i> 生成B视频
                            </button>
                        </div>
                        
                        <!-- 融合方案 -->
                        <div class="control-group">
                            <label><i class="ri-settings-3-line"></i> 融合方案</label>
                            <select id="fusion-method" onchange="updateABFusion()">
                                <option value="transparency">透明度混合 (推荐新手)</option>
                                <option value="region">区域替换 (更隐蔽)</option>
                                <option value="dynamic">动态混合 (高阶玩法)</option>
                            </select>
                        </div>
                        
                        <!-- 透明度混合设置 -->
                        <div class="fusion-settings" id="transparency-settings">
                            <div class="control-group">
                                <label>B视频透明度</label>
                                <div class="range-control">
                                    <input type="range" id="b-video-opacity" min="0.1" max="0.7" value="0.35" step="0.05" oninput="updateABFusion()">
                                    <span id="opacity-value">35%</span>
                                </div>
                            </div>
                            <div class="checkbox-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="adaptive-opacity" onchange="updateABFusion()">
                                    <i class="ri-checkbox-blank-line unchecked"></i>
                                    <i class="ri-checkbox-line checked"></i>
                                    <span>自适应透明度</span>
                                </label>
                            </div>
                        </div>
                        
                        <!-- 区域替换设置 -->
                        <div class="fusion-settings" id="region-settings" style="display: none;">
                            <div class="control-group">
                                <label>替换区域</label>
                                <div class="region-options">
                                    <label class="radio-label">
                                        <input type="radio" name="region" value="corners" checked>
                                        <span>四角区域</span>
                                    </label>
                                    <label class="radio-label">
                                        <input type="radio" name="region" value="edges">
                                        <span>边缘区域</span>
                                    </label>
                                    <label class="radio-label">
                                        <input type="radio" name="region" value="center">
                                        <span>中心区域</span>
                                    </label>
                                </div>
                            </div>
                            <div class="control-group">
                                <label>替换比例</label>
                                <div class="range-control">
                                    <input type="range" id="region-ratio" min="0.1" max="0.5" value="0.25" step="0.05" oninput="updateABFusion()">
                                    <span id="region-ratio-value">25%</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 动态混合设置 -->
                        <div class="fusion-settings" id="dynamic-settings" style="display: none;">
                            <div class="control-group">
                                <label>变化周期(秒)</label>
                                <input type="number" id="dynamic-cycle" min="3" max="30" value="5" onchange="updateABFusion()">
                            </div>
                            <div class="control-group">
                                <label>透明度范围</label>
                                <div class="range-inputs">
                                    <input type="number" id="opacity-min" min="0.1" max="0.7" value="0.2" step="0.05" placeholder="最小">
                                    <span>-</span>
                                    <input type="number" id="opacity-max" min="0.1" max="0.7" value="0.5" step="0.05" placeholder="最大">
                                </div>
                            </div>
                        </div>
                        
                        <!-- 增效技巧 -->
                        <div class="advanced-options">
                            <div class="checkbox-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="metadata-disguise" onchange="updateABFusion()">
                                    <i class="ri-checkbox-blank-line unchecked"></i>
                                    <i class="ri-checkbox-line checked"></i>
                                    <span>元数据伪装</span>
                                </label>
                            </div>
                            <div class="checkbox-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="audio-phase-adjust" onchange="updateABFusion()">
                                    <i class="ri-checkbox-blank-line unchecked"></i>
                                    <i class="ri-checkbox-line checked"></i>
                                    <span>音频相位调整</span>
                                </label>
                            </div>
                            <div class="checkbox-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="keyframe-modify" onchange="updateABFusion()">
                                    <i class="ri-checkbox-blank-line unchecked"></i>
                                    <i class="ri-checkbox-line checked"></i>
                                    <span>关键帧分布修改</span>
                                </label>
                            </div>
                        </div>
                        
                        <!-- 预设配置 -->
                        <div class="preset-configs">
                            <label>平台优化预设</label>
                            <div class="preset-buttons">
                                <button class="preset-btn" onclick="applyPreset('douyin')">
                                    <i class="ri-music-line"></i> 抖音优化
                                </button>
                                <button class="preset-btn" onclick="applyPreset('youtube')">
                                    <i class="ri-youtube-line"></i> YouTube优化
                                </button>
                                <button class="preset-btn" onclick="applyPreset('kuaishou')">
                                    <i class="ri-video-line"></i> 快手优化
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 分辨率设置 -->
            <div class="section">
                <h2><i class="ri-artboard-line"></i> 分辨率设置</h2>
                <div class="resolution-controls">
                    <div class="resolution-presets">
                        <button class="preset-btn original active" data-width="original" data-height="original">
                            <i class="ri-film-line"></i> 保持原分辨率
                        </button>
                        <button class="preset-btn" data-width="1920" data-height="1080">1920×1080</button>
                        <button class="preset-btn" data-width="1280" data-height="720">1280×720</button>
                        <button class="preset-btn" data-width="854" data-height="480">854×480</button>
                        <button class="preset-btn custom" onclick="toggleCustomResolution()">自定义</button>
                    </div>
                    
                    <div class="custom-resolution" id="custom-resolution" style="display: none;">
                        <div class="resolution-input">
                            <input type="number" id="custom-width" placeholder="宽度" min="100" max="4096">
                            <span>×</span>
                            <input type="number" id="custom-height" placeholder="高度" min="100" max="4096">
                        </div>
                    </div>
                    
                    <div class="control-group">
                        <label><i class="ri-aspect-ratio-line"></i> 调整模式</label>
                        <select id="scale-mode">
                            <option value="stretch">拉伸适应</option>
                            <option value="crop">裁切适应</option>
                            <option value="letterbox">添加黑边</option>
                            <option value="pad">填充模糊</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- 旋转翻转 -->
            <div class="section">
                <h2><i class="ri-refresh-line"></i> 旋转翻转</h2>
                <div class="transform-controls">
                    <div class="checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="keep-original-transform" checked onchange="toggleOriginalTransform()">
                            <i class="ri-checkbox-blank-line unchecked"></i>
                            <i class="ri-checkbox-line checked"></i>
                            <span>保持原始方向</span>
                        </label>
                    </div>
                    
                    <div class="transform-buttons" id="transform-buttons" style="display: none;">
                        <button class="transform-btn" data-transform="rotate-left">
                            <i class="ri-anticlockwise-line"></i>
                            <span>左转90°</span>
                        </button>
                        <button class="transform-btn" data-transform="rotate-right">
                            <i class="ri-clockwise-line"></i>
                            <span>右转90°</span>
                        </button>
                        <button class="transform-btn" data-transform="flip-h">
                            <i class="ri-swap-line"></i>
                            <span>水平翻转</span>
                        </button>
                        <button class="transform-btn" data-transform="flip-v">
                            <i class="ri-swap-fill"></i>
                            <span>垂直翻转</span>
                        </button>
                        <button class="transform-btn random" onclick="randomTransform()">
                            <i class="ri-shuffle-line"></i>
                            <span>随机翻转</span>
                        </button>
                        <button class="reset-transform-btn" onclick="resetTransform()">
                            <i class="ri-restart-line"></i>
                            <span>重置变换</span>
                        </button>
                    </div>
                    
                    <div class="checkbox-group" id="black-bars-option" style="display: none;">
                        <label class="checkbox-label">
                            <input type="checkbox" id="remove-black-bars" onchange="updateTransform()">
                            <i class="ri-checkbox-blank-line unchecked"></i>
                            <i class="ri-checkbox-line checked"></i>
                            <span>去除黑边</span>
                        </label>
                    </div>
                </div>
            </div>
        </div>

        <!-- 右侧：高级设置 -->
        <div class="editor-right">
            <!-- 帧率设置 -->
            <div class="section">
                <h2><i class="ri-speed-line"></i> 帧率设置</h2>
                <div class="framerate-controls">
                    <div class="checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="keep-original-fps" checked onchange="toggleOriginalFps()">
                            <i class="ri-checkbox-blank-line unchecked"></i>
                            <i class="ri-checkbox-line checked"></i>
                            <span>保持原帧率</span>
                        </label>
                    </div>
                    
                    <div class="control-group" id="fps-settings" style="display: none;">
                        <label>目标帧率 (FPS)</label>
                        <div class="framerate-input">
                            <input type="number" id="target-fps" min="12" max="120" value="30" step="0.1">
                            <button class="random-btn" onclick="randomFramerate()">
                                <i class="ri-shuffle-line"></i>
                            </button>
                        </div>
                    </div>
                    
                    <div class="framerate-range">
                        <label>随机范围</label>
                        <div class="range-inputs">
                            <input type="number" id="fps-min" min="12" max="120" value="24" step="0.1" placeholder="最小">
                            <span>-</span>
                            <input type="number" id="fps-max" min="12" max="120" value="30" step="0.1" placeholder="最大">
                        </div>
                    </div>
                </div>
            </div>

            <!-- 抽帧设置 -->
            <div class="section">
                <h2><i class="ri-skip-forward-line"></i> 抽帧设置</h2>
                <div class="frame-skip-controls">
                    <div class="checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="enable-frame-skip" onchange="toggleFrameSkip()">
                            <i class="ri-checkbox-blank-line unchecked"></i>
                            <i class="ri-checkbox-line checked"></i>
                            <span>启用抽帧</span>
                        </label>
                    </div>
                    
                    <div class="frame-skip-options" id="frame-skip-options" style="display: none;">
                        <div class="control-group">
                            <label>抽帧规则</label>
                            <div class="skip-range">
                                <input type="number" id="skip-start" min="1" max="100" value="25" placeholder="起始帧">
                                <span>-</span>
                                <input type="number" id="skip-end" min="1" max="100" value="30" placeholder="结束帧">
                                <span>抽一帧</span>
                            </div>
                        </div>
                        
                        <div class="skip-info">
                            <i class="ri-information-line"></i>
                            <span>每 <span id="skip-display">25-30</span> 帧抽取一帧</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 动态缩放 -->
            <div class="section">
                <h2><i class="ri-zoom-in-line"></i> 动态缩放</h2>
                <div class="zoom-controls">
                    <div class="checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="enable-zoom" onchange="toggleZoom()">
                            <i class="ri-checkbox-blank-line unchecked"></i>
                            <i class="ri-checkbox-line checked"></i>
                            <span>启用动态缩放</span>
                        </label>
                    </div>
                    
                    <div class="zoom-options" id="zoom-options" style="display: none;">
                        <div class="control-group">
                            <label>缩放幅度</label>
                            <div class="zoom-range">
                                <input type="number" id="zoom-min" min="0.01" max="1.0" value="0.01" step="0.01" placeholder="最小">
                                <span>-</span>
                                <input type="number" id="zoom-max" min="0.01" max="1.0" value="0.10" step="0.01" placeholder="最大">
                            </div>
                        </div>
                        
                        <div class="control-group">
                            <label>缩放方向</label>
                            <select id="zoom-direction">
                                <option value="in">放大</option>
                                <option value="out">缩小</option>
                                <option value="random">随机</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 码率调整 -->
            <div class="section">
                <h2><i class="ri-bar-chart-line"></i> 码率调整</h2>
                <div class="bitrate-controls">
                    <div class="checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="keep-original-bitrate" checked onchange="toggleOriginalBitrate()">
                            <i class="ri-checkbox-blank-line unchecked"></i>
                            <i class="ri-checkbox-line checked"></i>
                            <span>保持原码率</span>
                        </label>
                    </div>
                    
                    <div class="bitrate-mode" id="bitrate-mode-settings" style="display: none;">
                        <div class="radio-group">
                            <label>
                                <input type="radio" name="bitrate-mode" value="multiplier" checked>
                                <i class="ri-radio-button-line unchecked"></i>
                                <i class="ri-checkbox-circle-line checked"></i>
                                <span>倍率调整</span>
                            </label>
                            <label>
                                <input type="radio" name="bitrate-mode" value="fixed">
                                <i class="ri-radio-button-line unchecked"></i>
                                <i class="ri-checkbox-circle-line checked"></i>
                                <span>固定码率</span>
                            </label>
                        </div>
                    </div>
                    
                    <div class="bitrate-multiplier" id="bitrate-multiplier">
                        <div class="control-group">
                            <label>倍率范围</label>
                            <div class="multiplier-range">
                                <input type="number" id="bitrate-min" min="0.1" max="5.0" value="1.05" step="0.05" placeholder="最小">
                                <span>-</span>
                                <input type="number" id="bitrate-max" min="0.1" max="5.0" value="1.95" step="0.05" placeholder="最大">
                            </div>
                        </div>
                    </div>
                    
                    <div class="bitrate-fixed" id="bitrate-fixed" style="display: none;">
                        <div class="control-group">
                            <label>目标码率</label>
                            <div class="bitrate-input">
                                <input type="number" id="fixed-bitrate" min="100" max="50000" value="3000" placeholder="码率">
                                <span>kb/s</span>
                            </div>
                        </div>
                    </div>
                    
                    <button class="reset-btn" onclick="resetBitrate()">
                        <i class="ri-restart-line"></i> 重置码率设置
                    </button>
                </div>
            </div>

            <!-- 处理按钮 -->
            <div class="section process-section">
                <h2><i class="ri-video-download-line"></i> 视频处理</h2>
                <div class="process-controls">
                    <button class="process-btn" id="process-btn" onclick="processVideo()" disabled>
                        <i class="ri-play-circle-line"></i>
                        <span>开始处理</span>
                    </button>
                    
                    <div class="process-info">
                        <div class="settings-summary" id="settings-summary">
                            <h4>当前设置预览：</h4>
                            <ul id="settings-list">
                                <li>请先选择视频文件</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="process-status" id="progress-section" style="display: none;">
                        <div class="status-message">
                            <i class="ri-loader-line spinning"></i>
                            <span>正在处理视频...</span>
                        </div>
                        <div class="progress-bar" id="progress-bar">
                            <div class="progress-fill" id="progress-fill"></div>
                        </div>
                        <div class="progress-text" id="progress-text">0%</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 预设管理模态框 -->
    <div id="preset-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="ri-save-line"></i> 预设管理</h3>
                <button class="close-btn" onclick="closePresetModal()">
                    <i class="ri-close-line"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="preset-form">
                    <h4>保存新预设</h4>
                    <div class="form-group">
                        <input type="text" id="preset-name" placeholder="输入预设名称">
                        <button onclick="saveNewPreset()">保存</button>
                    </div>
                </div>
                
                <div class="preset-list">
                    <h4>已保存的预设</h4>
                    <div id="preset-items">
                        <div class="empty-preset">
                            <i class="ri-folder-open-line"></i>
                            <p>暂无保存的预设</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="/static/js/video_editor.js"></script>
</body>
</html> 